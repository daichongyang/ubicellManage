webpackJsonp([77],{"4je1":function(t,e){},"57/v":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("LOkV"),i=a("qKdJ"),l={data:function(){return{aaa:"",headIcon:"",dushuNum:"",dushu:!1,total:1,addFormVisible:!1,addFormVisible1:!1,addFormVisible2:!1,listLoading:!1,sels:[],checkList:[],xqTree:[],inforList:[],selectArr:[],formSearch:{current:1,size:10,xqId:""},addForm:{},updataForm:{}}},methods:{reloadCon:function(){location.reload()},checkNum:function(t,e,a){console.log(a);var n={houseId:t,type:a.devType};console.log(n),getPowerNumberByHouseId(n).then(function(t){console.log(t),200===t.data.code?a.nowNum=t.data.data:alert("更新失败")})},showBill:function(){console.log(this.sels);var t=this;if(0!=this.sels.length)this.sels.filter(function(e){for(var a=0;a<e.handwritten.length;a++){if(e.handwritten[a].nowNum-e.handwritten[a].lastNum==0)return void(t.addFormVisible1=!0);if(e.handwritten[a].nowNum&&e.handwritten[a].nowNum-e.handwritten[a].lastNum<0)return void(t.addFormVisible2=!0)}return e});else alert("请勾选您要生成账单的房间")},gocharging_config_price:function(){this.$router.push({path:"/charging_config_price"})},updateInfor:function(){var t=this,e=this,a=[];this.sels.filter(function(t){for(var n=0;n<t.handwritten.length;n++){var i={createType:e.addForm.createType,payTime:e.addForm.payTime,devType:t.handwritten[n].devType,endNum:t.handwritten[n].nowNum,startNum:t.handwritten[n].lastNum,startTime:t.handwritten[n].lastTime,houseId:t.houseId,leaseId:t.leaseId};a.push(i)}return t});console.log(a),0!=a.length?(Object(i._95)(a).then(function(e){console.log(e),200===e.data.code?(t.$message("生成账单成功"),t.getlist()):109==e.data.code?t.$message(e.data.msg):t.$message("生成账单失败")}).catch(function(e){t.$message("请求失败")}),this.addFormVisible=!1):alert("请勾选需要生成账单的水电表")},getlist:function(){var t=this,e=this.formSearch;console.log(e),Object(i._96)(e).then(function(e){console.log(e),200===e.data.code&&(t.inforList=e.data.data.records.filter(function(t){for(var e=0;e<t.handwritten.length;e++)t.handwritten[e].lastTime&&(t.handwritten[e].lastTimee=Object(n.a)(t.handwritten[e].lastTime)[9]),t.handwritten[e].lastNum&&(t.handwritten[e].lastNum=t.handwritten[e].lastNum.toFixed(2)),t.handwritten[e].nowNum&&(t.handwritten[e].nowNum=t.handwritten[e].nowNum.toFixed(2));return t}),t.total=e.data.data.pages)})},changeItem:function(t,e){},handleCurrentChange:function(t){this.formSearch.current=t,this.getlist()},selsChange:function(t){console.log(t),this.sels=t.filter(function(t){if(1!==t.isExist)return t})}},mounted:function(){var t=this;Object(i._209)({}).then(function(e){console.log(e),200==e.data.code&&(t.xqTree=e.data.data,0!=t.xqTree.length&&(t.formSearch.xqId=t.xqTree[0].id,t.getlist()))})}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"modlude"},[a("el-col",{staticClass:"toolbar",staticStyle:{"padding-bottom":"0px"},attrs:{span:24}},[a("el-form",{staticClass:"gridContt",attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"选择小区",size:"small"}},[a("el-select",{attrs:{placeholder:"请选择小区"},on:{change:t.getlist},model:{value:t.formSearch.xqId,callback:function(e){t.$set(t.formSearch,"xqId",e)},expression:"formSearch.xqId"}},t._l(t.xqTree,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.getlist}},[t._v("查询")])],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.gocharging_config_price}},[t._v("配置单价")])],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"warning",size:"small"},on:{click:t.showBill}},[t._v("生成账单")])],1)],1)],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:t.inforList,"highlight-current-row":""},on:{"selection-change":t.selsChange}},[a("el-table-column",{staticClass:"ccc",attrs:{type:"selection",width:"55",label:"全选"}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"门牌号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"tenant",label:"承租人"}}),t._v(" "),a("el-table-column",{attrs:{prop:"",label:"类型"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.handwritten?a("div",{staticStyle:{"line-height":"40px"}},[t._v(t._s(1==e.row.handwritten[0].devType?"冷水表":2==e.row.handwritten[0].devType?"电表":"热水表"))]):t._e(),t._v(" "),e.row.handwritten?a("div",{staticStyle:{"line-height":"40px"}},[t._v(t._s(1==e.row.handwritten[1].devType?"冷水表":2==e.row.handwritten[1].devType?"电表":"热水表"))]):t._e(),t._v(" "),e.row.handwritten?a("div",{staticStyle:{"line-height":"40px"}},[t._v(t._s(1==e.row.handwritten[2].devType?"冷水表":2==e.row.handwritten[2].devType?"电表":"热水表"))]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"typeName",label:"上次度数"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{staticClass:"shuidianmei",staticStyle:{width:"100px"},attrs:{palceholder:"请输入"},model:{value:e.row.handwritten[0].lastNum,callback:function(a){t.$set(e.row.handwritten[0],"lastNum",a)},expression:"scope.row.handwritten[0].lastNum"}}),t._v(" "),a("el-input",{staticClass:"shuidianmei",staticStyle:{width:"100px"},attrs:{palceholder:"请输入"},model:{value:e.row.handwritten[1].lastNum,callback:function(a){t.$set(e.row.handwritten[1],"lastNum",a)},expression:"scope.row.handwritten[1].lastNum"}}),t._v(" "),a("el-input",{staticClass:"shuidianmei",staticStyle:{width:"100px"},attrs:{palceholder:"请输入"},model:{value:e.row.handwritten[2].lastNum,callback:function(a){t.$set(e.row.handwritten[2],"lastNum",a)},expression:"scope.row.handwritten[2].lastNum"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"本次度数"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{staticClass:"shuidianmei",staticStyle:{width:"100px"},attrs:{palceholder:"请输入"},model:{value:e.row.handwritten[0].nowNum,callback:function(a){t.$set(e.row.handwritten[0],"nowNum",a)},expression:"scope.row.handwritten[0].nowNum"}}),t._v(" "),a("el-input",{staticClass:"shuidianmei",staticStyle:{width:"100px"},attrs:{palceholder:"请输入"},model:{value:e.row.handwritten[1].nowNum,callback:function(a){t.$set(e.row.handwritten[1],"nowNum",a)},expression:"scope.row.handwritten[1].nowNum"}}),t._v(" "),a("el-input",{staticClass:"shuidianmei",staticStyle:{width:"100px"},attrs:{palceholder:"请输入"},model:{value:e.row.handwritten[2].nowNum,callback:function(a){t.$set(e.row.handwritten[2],"nowNum",a)},expression:"scope.row.handwritten[2].nowNum"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"promiseMan",label:"用量",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticStyle:{"line-height":"40px"}},[t._v(t._s(null==e.row.handwritten[0].nowNum||null==e.row.handwritten[0].lastNum?0:(e.row.handwritten[0].nowNum-e.row.handwritten[0].lastNum).toFixed(2))+"\n          ")]),t._v(" "),a("div",{staticStyle:{"line-height":"40px"}},[t._v(t._s(null==e.row.handwritten[1].nowNum||null==e.row.handwritten[1].lastNum?0:(e.row.handwritten[1].nowNum-e.row.handwritten[1].lastNum).toFixed(2)))]),t._v(" "),a("div",{staticStyle:{"line-height":"40px"}},[t._v(t._s(null==e.row.handwritten[2].nowNum||null==e.row.handwritten[2].lastNum?0:(e.row.handwritten[2].nowNum-e.row.handwritten[2].lastNum).toFixed(2)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticStyle:{"line-height":"40px"}},[1==e.row.handwritten[0].isAuto?a("el-button",{attrs:{size:"small"},on:{click:function(a){return t.checkNum(e.row.houseId,e.row.leaseId,e.row.handwritten[0])}}},[t._v("更新读数")]):t._e()],1),t._v(" "),a("div",{staticStyle:{"line-height":"40px"}},[1==e.row.handwritten[1].isAuto?a("el-button",{attrs:{size:"small"},on:{click:function(a){return t.checkNum(e.row.houseId,e.row.leaseId,e.row.handwritten[1])}}},[t._v("更新读数")]):t._e()],1),t._v(" "),a("div",{staticStyle:{"line-height":"40px"}},[1==e.row.handwritten[2].isAuto?a("el-button",{attrs:{size:"small"},on:{click:function(a){return t.checkNum(e.row.houseId,e.row.leaseId,e.row.handwritten[2])}}},[t._v("更新读数")]):t._e()],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"lastTime",label:"上次抄表时间",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticStyle:{"line-height":"40px"}},[t._v(t._s(e.row.handwritten[0].lastTimee))]),t._v(" "),a("div",{staticStyle:{"line-height":"40px"}},[t._v(t._s(e.row.handwritten[1].lastTimee))]),t._v(" "),a("div",{staticStyle:{"line-height":"40px"}},[t._v(t._s(e.row.handwritten[2].lastTimee))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"latestTime",label:"表类型"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{class:{green:1==e.row.handwritten[0].isAuto},staticStyle:{"line-height":"40px"}},[t._v(t._s(0==e.row.handwritten[0].isAuto?"手抄表":"智能表"))]),t._v(" "),a("div",{class:{green:1==e.row.handwritten[1].isAuto},staticStyle:{"line-height":"40px"}},[t._v(t._s(0==e.row.handwritten[1].isAuto?"手抄表":"智能表"))]),t._v(" "),a("div",{class:{green:1==e.row.handwritten[2].isAuto},staticStyle:{"line-height":"40px"}},[t._v(t._s(0==e.row.handwritten[2].isAuto?"手抄表":"智能表"))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"rentCost",label:"抄表状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{class:{green:1==e.row.handwritten[0].status,red:0==e.row.handwritten[0].status},staticStyle:{"line-height":"40px"}},[t._v(t._s(0==e.row.handwritten[0].status?"本月未抄":"本月已抄"))]),t._v(" "),a("div",{class:{green:1==e.row.handwritten[1].status,red:0==e.row.handwritten[1].status},staticStyle:{"line-height":"40px"}},[t._v(t._s(0==e.row.handwritten[1].status?"本月未抄":"本月已抄"))]),t._v(" "),a("div",{class:{green:1==e.row.handwritten[2].status,red:0==e.row.handwritten[2].status},staticStyle:{"line-height":"40px"}},[t._v(t._s(0==e.row.handwritten[2].status?"本月未抄":"本月已抄"))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",fixed:"right",width:"250"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"small"},on:{click:t.showBill}},[t._v("保存")])]}}])})],1),t._v(" "),a("el-dialog",{attrs:{title:"生成账单",visible:t.addFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.addFormVisible=e}}},[a("el-form",{ref:"addForm",attrs:{model:t.addForm,"label-width":"110px"}},[a("el-form-item",{attrs:{size:"small",label:"账单生成方式"}},[a("el-select",{attrs:{size:"small",placeholder:"请选择账单生成方式"},model:{value:t.addForm.createType,callback:function(e){t.$set(t.addForm,"createType",e)},expression:"addForm.createType"}},[a("el-option",{attrs:{label:"跟随账期",value:0}}),t._v(" "),a("el-option",{attrs:{label:"指定支付日期",value:1}})],1)],1),t._v(" "),1==t.addForm.createType?a("el-form-item",{attrs:{label:"账单支付时间"}},[a("el-date-picker",{attrs:{type:"date","value-format":"timestamp"},model:{value:t.addForm.payTime,callback:function(e){t.$set(t.addForm,"payTime",e)},expression:"addForm.payTime"}})],1):t._e()],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(e){t.addFormVisible=!1}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return t.updateInfor(e)}}},[t._v("提交")])],1)],1),t._v(" "),a("el-dialog",{attrs:{visible:t.addFormVisible1},on:{"update:visible":function(e){t.addFormVisible1=e}}},[a("span",[t._v("有表用量为0，是否继续")]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.addFormVisible1=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.addFormVisible=!0,t.addFormVisible1=!1}}},[t._v("确 定")])],1)]),t._v(" "),a("el-dialog",{attrs:{visible:t.addFormVisible2},on:{"update:visible":function(e){t.addFormVisible2=e}}},[a("span",[t._v("有表用量小于0")]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.addFormVisible=!1}}},[t._v("确 定")])],1)]),t._v(" "),a("el-col",{staticClass:"paginationt",attrs:{span:24}},[a("el-pagination",{staticClass:"pagination",attrs:{layout:"prev, pager, next","page-size":10,"page-count":t.total},on:{"current-change":t.handleCurrentChange}})],1)],1)},staticRenderFns:[]};var r=a("VU/8")(l,o,!1,function(t){a("4je1")},"data-v-0b5e79fa",null);e.default=r.exports}});
//# sourceMappingURL=77.90c46fb2b5bae1f064cc.js.map